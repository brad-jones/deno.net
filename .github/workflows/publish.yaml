on:
  workflow_dispatch:
  push:
    branches:
      - master

jobs:
  container:
    uses: ./.github/workflows/_publish.yaml
    secrets: inherit
    permissions:
      id-token: write
      contents: write
      packages: write
      attestations: write
    with:
      project: container

  problem-details:
    needs: [container]
    uses: ./.github/workflows/_publish.yaml
    secrets: inherit
    permissions:
      id-token: write
      contents: write
      packages: write
      attestations: write
    with:
      project: problem-details

  http-context:
    needs: [problem-details]
    uses: ./.github/workflows/_publish.yaml
    secrets: inherit
    permissions:
      id-token: write
      contents: write
      packages: write
      attestations: write
    with:
      project: http-context

  logging:
    needs: [http-context]
    uses: ./.github/workflows/_publish.yaml
    secrets: inherit
    permissions:
      id-token: write
      contents: write
      packages: write
      attestations: write
    with:
      project: logging

  middleware:
    needs: [logging]
    uses: ./.github/workflows/_publish.yaml
    secrets: inherit
    permissions:
      id-token: write
      contents: write
      packages: write
      attestations: write
    with:
      project: middleware

  app-builder:
    needs: [middleware]
    uses: ./.github/workflows/_publish.yaml
    secrets: inherit
    permissions:
      id-token: write
      contents: write
      packages: write
      attestations: write
    with:
      project: app-builder
